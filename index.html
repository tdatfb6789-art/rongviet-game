<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Game CÃ¡ CÆ°á»£c TimeSticks â€“ TÃ i/Xá»‰u + Giftcode</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin: 40px; background-color: #f4f4f4; }
    button, input { padding: 10px 20px; margin: 10px; font-size: 16px; }
    .money { font-weight: bold; color: green; font-size: 20px; }
    #history { max-height: 200px; overflow-y: auto; background: #fff; padding: 10px; border: 1px solid #ccc; margin: 0 auto; width: 80%; }
    input[type="text"], input[type="number"] { width: 200px; }
    .giftbox { background: #fff; padding: 15px; border: 1px solid #ccc; width: 400px; margin: 20px auto; }
  </style>
</head>
<body>

  <h1>ğŸ² Game CÃ¡ CÆ°á»£c TimeSticks â€“ TÃ i/Xá»‰u + Giftcode</h1>
  <p>Sá»‘ dÆ°: <span class="money" id="balance">0</span> VNÄ</p>

  <label for="betAmount">ğŸ’¸ Sá»‘ tiá»n cÆ°á»£c (VNÄ):</label>
  <input type="number" id="betAmount" min="1" value="1000000"><br>

  <button onclick="placeBet('tai')">CÆ°á»£c TÃ i</button>
  <button onclick="placeBet('xiu')">CÆ°á»£c Xá»‰u</button>
  <button onclick="resetGame()">ğŸ”„ Reset tiá»n</button>

  <h3 id="result"></h3>
  <p>TimeSticks: <span id="timestamp"></span></p>

  <h3>Lá»‹ch sá»­ cÆ°á»£c:</h3>
  <div id="history"></div>

  <div class="giftbox">
    <h3>ğŸ Nháº­p Giftcode nháº­n 2,000,000,000 VNÄ</h3>
    <input type="text" id="giftcodeInput" placeholder="Nháº­p mÃ£ giftcode">
    <button onclick="redeemGiftcode()">DÃ¹ng mÃ£</button>
    <p id="giftcodeMsg"></p>
  </div>

  <script>
    // Khá»Ÿi táº¡o tá»« localStorage náº¿u cÃ³
    let balance = parseInt(localStorage.getItem('balance')) || 150000000;
    let history = JSON.parse(localStorage.getItem('history')) || [];

    const giftcodes = {
      "GIFT2025-01": true,
      "GIFT2025-02": true,
      "GIFT2025-03": true,
      "GIFT2025-04": true,
      "GIFT2025-05": true,
      "GIFT2025-06": true,
      "GIFT2025-07": true,
      "GIFT2025-08": true,
      "GIFT2025-09": true,
      "GIFT2025-10": true
    };
    // Load tráº¡ng thÃ¡i giftcodes Ä‘Ã£ dÃ¹ng tá»« localStorage
    const usedGift = JSON.parse(localStorage.getItem('usedGiftcodes')) || {};
    Object.keys(usedGift).forEach(code => {
      if (giftcodes.hasOwnProperty(code)) {
        giftcodes[code] = false;
      }
    });

    function saveState() {
      localStorage.setItem('balance', balance);
      localStorage.setItem('history', JSON.stringify(history));
      localStorage.setItem('usedGiftcodes', JSON.stringify(
        Object.keys(giftcodes).filter(code => !giftcodes[code])
        .reduce((obj, code) => { obj[code] = true; return obj; }, {})
      ));
    }

    function updateDisplay() {
      document.getElementById("balance").textContent = balance.toLocaleString();
      const historyBox = document.getElementById("history");
      historyBox.innerHTML = history.map(h => `<div>${h}</div>`).reverse().join("");
    }

    function placeBet(choice) {
      const betInput = document.getElementById("betAmount");
      const resultDisplay = document.getElementById("result");
      const timestampDisplay = document.getElementById("timestamp");

      let bet = parseInt(betInput.value);
      if (isNaN(bet) || bet <= 0) {
        alert("Nháº­p sá»‘ tiá»n cÆ°á»£c há»£p lá»‡.");
        return;
      }
      if (bet > balance) {
        alert("KhÃ´ng Ä‘á»§ tiá»n Ä‘á»ƒ cÆ°á»£c!");
        return;
      }

      const now = Date.now();
      const lastDigit = now % 10;

      let outcome = (lastDigit <= 5) ? 'xiu' : 'tai';
      let win = (choice === outcome);
      let message = `Káº¿t quáº£: TimeSticks = ${lastDigit} â‡’ ${outcome.toUpperCase()} tháº¯ng<br>`;

      if (win) {
        const reward = Math.floor(bet * 2.4);
        balance += reward;
        message += `ğŸ‰ Báº¡n tháº¯ng! +${reward.toLocaleString()} VNÄ`;
        history.push(`âœ… Tháº¯ng ${choice.toUpperCase()} +${reward.toLocaleString()}`);
      } else {
        balance -= bet;
        message += `ğŸ˜¢ Báº¡n thua! -${bet.toLocaleString()} VNÄ`;
        history.push(`âŒ Thua ${choice.toUpperCase()} -${bet.toLocaleString()}`);
      }

      resultDisplay.innerHTML = message;
      timestampDisplay.textContent = now;
      saveState();
      updateDisplay();
    }

    function resetGame() {
      if (confirm("Báº¡n cÃ³ cháº¯c muá»‘n reset vá» 150 triá»‡u?")) {
        balance = 150000000;
        history.push("ğŸ”„ Reset vá» 150,000,000 VNÄ");
        saveState();
        updateDisplay();
      }
    }

    function redeemGiftcode() {
      const code = document.getElementById("giftcodeInput").value.trim().toUpperCase();
      const msgBox = document.getElementById("giftcodeMsg");

      if (giftcodes[code]) {
        balance += 2000000000;
        giftcodes[code] = false;
        msgBox.innerHTML = `ğŸ Nháº­n thÃ nh cÃ´ng 2,000,000,000 VNÄ tá»« giftcode: <b>${code}</b>`;
        history.push(`ğŸ Giftcode ${code} +2,000,000,000 VNÄ`);
        saveState();
        updateDisplay();
      } else {
        msgBox.innerHTML = `âŒ Giftcode khÃ´ng há»£p lá»‡ hoáº·c Ä‘Ã£ sá»­ dá»¥ng.`;
      }
    }

    // Khi trang load
    updateDisplay();
  </script>
</body>
</html>
